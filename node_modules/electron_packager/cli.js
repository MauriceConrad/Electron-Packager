#! /usr/bin/env node
const packager = require('.');


var args = parseArgv(process.argv, 2);

if (args["src"] == undefined) {
  return printHelp();
}



packager.package({
  source: args.src,
  platform: args.platform,
  target: args.target,
  name: args.name,
  icon: args.icon,
  identifier: args.identifier,
  version: "latest"
  /*required: {
    darwin: darwinResources
  }*/
}, function(err, result) {
  if (err) return console.error(err);
  console.log(result);
});


function parseArgv(argv, start) {
  var args = {};
  for (var i = start; i < argv.length; i++) {
    parts = argv[i].split("=");
    args[parts[0]] = parts[1];
  }
  return args;
}

function printHelp() {
  console.log("\nCommand Line Reference:");
  console.log("\n\nelectron_packager source=/path/to/source/folder");
  console.log("\n\nCLI Arguments:");
  console.log("\nsource     = /path/to/source/folder\ntarget     = /path/to/output/folder\nplatforms  = darwin || win || linux || all\nname       = Custom Name\nicon       = /path/to/icon.icns\nidentifier = com.developer.myapp");
  console.log("\nSyntax:\nargument=value");
  console.log("\nAll arguments are optional execpt the 'src' argument. If no 'target' is specified, the parent directory of the source folder will be used.\n\n");
}
